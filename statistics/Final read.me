
# ğŸ“Š Statistical Analysis for T2D Susceptibility Project

## ğŸ“ Description  
This repository contains a comprehensive **end-to-end pipeline** for identifying and analysing **Type 2 Diabetes (T2D)-associated SNPs**, with a particular focus on **South Asian populations**. The pipeline spans **data collection, filtering, annotation**, and **downstream population genetics analyses**, including:

- **Genetic differentiation tests** (e.g., FST, nSL)  
- **Permutation testing** for statistical significance  
- **Signal normalisation** using Z-score transformations  

---

## ğŸ¯ Project Goals  
âœ” Identify **T2D-associated genetic variants**  
âœ” Detect **positive selection signals** in **South Asian populations**  
âœ” Develop a robust statistical framework for genomic analysis  

---

## ğŸ“‚ Data Sources  

- **T2D-associated SNPs** from the [T2D Knowledge Portal](https://t2d.hugeamp.org)  
- **1000 Genomes Project** autosomal VCF files ([Download](https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/))  

---

## ğŸ”¬ Key Analyses  

âœ… **Population-based VCF filtering**  
âœ… **SNP selection & annotation**  
âœ… **Fixation index (FST) and nSL calculations**  
âœ… **Permutation testing** for significance assessment  
âœ… **Z-score normalisation** to enhance signal detection  

---

## ğŸ›  Requirements  

Ensure you have the following dependencies installed:  

bcftools
htslib
vcftools
numpy
selscan
```

Install missing packages using:  


sudo apt install bcftools htslib vcftools
pip install numpy

---

## âš¡ Pipeline Workflow  

### **Step 1: Collect T2D SNPs**  
ğŸ“¥ **Input:** CSV files containing **T2D-associated SNPs**, e.g.:  
```
T2DGGI2024T2DGWASassociations.csv  
DIAMANTE2022T2DGWASassociations.csv  
```
ğŸ”¹ Extract **rsID, chromosome, position, p-value** from the T2D Knowledge Portal.  

---

### **Step 2: Download 1000 Genomes Data**  
ğŸ“Œ **Download autosomal VCF files (chromosomes 1-22):**  

wget -r -np -nH --cut-dirs=5 -R index.html \
"https://ftp.1000genomes.ebi.ac.uk/vol1/ftp/release/20130502/"

ğŸ§¬ **These serve as reference panels for South Asian & European populations.**  

---

### **Step 3: Population-Based VCF Filtering**  
ğŸ›  **Script:** `population_filter.txt`  
ğŸ¯ **Objective:** Extract population-specific samples (e.g., **BEB, GIH, ITU, STU, CEU**)  

ğŸ”¹ **Method:**  

bcftools view -S sampleID.txt -Oz -o filtered_population.vcf.gz input.vcf.gz

ğŸ”¹ **Parallel Processing (Chromosomes 1-22):**  

for chr in {1..22}; do
    bcftools view -S sampleID.txt -Oz -o chr${chr}_filtered.vcf.gz chr${chr}.vcf.gz
done

---

### **Step 4: Extract Chromosome Positions**  
ğŸ›  **Script:** `extract_chrom_positions.py`  

python3 extract_chrom_positions.py
```
ğŸ”¹ **Output:** `t2d_chrom_position.txt` (used to filter VCF files)  

---

### **Step 5: Filter SNPs from Autosomal VCF Files**  
ğŸ›  **Command:**  

ls ALL.chr*.vcf.gz | parallel -j 4 'vcftools --gzvcf {} \
  --positions t2d_chrom_position.txt --recode --out {/.}_filtered'
```
ğŸ”¹ **Output:** `ALL.chrX_filtered.recode.vcf`  

---

### **Step 6: Merge Filtered VCF Files**  

bcftools concat ALL.chr*.vcf_filtered.recode.vcf -O z -o all_chromosomes.vcf.gz
```
ğŸ”¹ **Output:** `all_chromosomes.vcf.gz` (Merged T2D-associated SNPs)  

---

### **Step 7: Annotate VCF with rsIDs**  
ğŸ›  **Script:** `annotate_merged_vcf_withsnps.py`  

python3 annotate_merged_vcf_withsnps.py
```
ğŸ”¹ **Output:** `snps_annotated_all_chromosomes.vcf.gz`  

---

### **Step 8: Calculate FST (Fixation Index)**  

vcftools --gzvcf snps_annotated_all_chromosomes.vcf.gz \
  --weir-fst-pop Punjabi_sampleID.txt \
  --weir-fst-pop CEU_samples.txt \
  --out Fst_results_Punjabi_CEU
```
ğŸ”¹ **Repeat for other populations** (GIH, ITU, BEB vs. European reference).  

---

### **Step 9: Normalisation of Selection Signals**  
ğŸ“Œ **Goal:** Enhance **outlier detection** and facilitate **cross-population comparisons**  
ğŸ›  **Method:** Z-score transformation applied to **nSL** and optionally **FST** values.  

```python
import numpy as np

def normalise_zscore(data):
    return (data - np.mean(data)) / np.std(data)

normalised_values = normalise_zscore(selection_signals)
```

---

## ğŸ† Notes & Considerations  

ğŸ“Œ **Liftover:** Ensure genomic positions match reference assembly (GRCh37 vs. GRCh38).  
ğŸ“Œ **Parallelisation:** Recommended for computationally intensive steps (e.g., selscan).  
ğŸ“Œ **Script Adjustments:** Update file paths, sample IDs, and variable names accordingly.  

---

## ğŸ“œ Citations & References  

- **T2D Knowledge Portal** - [Website](https://t2d.hugeamp.org/)  
- **1000 Genomes Project** - [Website](https://www.internationalgenome.org/)  
- **GWAS Catalogue** - [Website](https://www.ebi.ac.uk/gwas/)  
- **Functional Annotations** - [Gene Ontology](https://geneontology.org/)  

---

ğŸš€ **If you find this repository useful, give it a star!** â­  
